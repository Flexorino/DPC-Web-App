<div *ngIf="!ready" class="full-screen-loader"><mat-spinner></mat-spinner></div>
<div id="content">
    <div>
        <mat-horizontal-stepper [linear]="isLinear" #stepper [formGroup]="mainFormGroup">
            <mat-step [stepControl]="firstFormGroup">
                <div formGroupName="timeAndBs">
                    <ng-template matStepLabel>Zeit & <br> Blutzucker</ng-template>
                    <h3>Zeitpunkt:</h3>
                    <mat-form-field class="fullWidthInput">
                        <input class="fullWidthInput" matInput placeholder="Zeit" formControlName="time" required
                            [ngxTimepicker]="picker" [format]="24">
                        <ngx-material-timepicker #picker [ngxMaterialTimepickerTheme]="$candy-app-theme">
                        </ngx-material-timepicker>
                    </mat-form-field>
                    <mat-form-field class="fullWidthInput">
                        <input [matDatepicker]="date_picker" class="fullWidthInput" matInput placeholder="Datum"
                            formControlName="date" required>
                        <mat-datepicker-toggle matSuffix [for]="date_picker"></mat-datepicker-toggle>
                        <mat-datepicker #date_picker></mat-datepicker>
                    </mat-form-field>
                    <h3>Blutzucker</h3>
                    <mat-form-field class="fullWidthInput">
                        <input class="fullWidthInput" matInput placeholder="Blutzucker" formControlName="bs"
                            type="number">
                        <span matSuffix>{{bsUnit.identifier}}</span>
                    </mat-form-field>

                </div>
            </mat-step>
            <mat-step>
                <div formGroupName="mealForm">
                    <ng-template matStepLabel>Nahrung</ng-template>
                    <h3>Nahrung</h3>
                    <div formArrayName="meals">
                        <div *ngFor="let meal of meals.controls; let i=index">
                            <app-meal-selection (close)="remove(i)" [group]="meal"></app-meal-selection>
                        </div>
                    </div>
                </div>
                <button class="fullWidthInput" mat-raised-button color="primary" (click)="addMeal()">Füge Nahrung
                    hinzu</button>
            </mat-step>
            <mat-step>
                <ng-template matStepLabel>Bolus etc.</ng-template>
                <h3>Bolus berechnen</h3>
                <mat-form-field class="fullWidthInput">
                    <input class="fullWidthInput" matInput placeholder="Essens-Bolus" type="number">
                    <span matSuffix>IE</span>
                </mat-form-field>
                <mat-card class="delayedBolus" [ngClass]="{'delayedBolusExpanded': delayedBolus}">
                    <mat-checkbox class="example-margin" [(ngModel)]="delayedBolus"
                        [ngModelOptions]="{standalone: true}">Verzögerte Bolus</mat-checkbox>

                    <mat-form-field class="fullWidthInput">
                        <input class="fullWidthInput" matInput placeholder="Essens-Bolus" type="number">
                        <span matSuffix>IE</span>
                    </mat-form-field>
                </mat-card>
                <mat-form-field class="fullWidthInput">
                    <input class="fullWidthInput" matInput placeholder="Korrektur-Bolus" type="number">
                    <span matSuffix>IE</span>
                </mat-form-field>
                <button class="fullWidthInput" mat-raised-button color="primary" (click)="addMeal()">Berechne
                    Bolus</button>
                <button class="fullWidthInput" mat-raised-button color="primary" (click)="addMeal()">Vergleiche mit
                    anderen Einträgen</button>
            </mat-step>
        </mat-horizontal-stepper>
    </div>
</div>



<mat-toolbar *ngIf="currentStep ===1" class="mat-elevation-z4 BottomToolbar" color='primary'>

    Summe: {{sum}} KE
</mat-toolbar>
<mat-toolbar class="mat-elevation-z4 BottomToolbar" color='primary'>
    <div id="l">
        <span *ngIf="currentStep!=0" id="back" routerLink="./" fragment="{{currentStep-1}}"
            class="material-icons">arrow_back</span>
    </div>
    <div id="r">
        <span *ngIf="!isLastStep" id="forward" routerLink="./" fragment="{{currentStep+1}}"
            class="material-icons">arrow_forward</span>
        <span *ngIf="isLastStep" (click)="submit()"
            class="material-icons">check</span>
    </div>


</mat-toolbar>


<!-- Copyright 2019 Google Inc. All Rights Reserved.
      Use of this source code is governed by an MIT-style license that
      can be found in the LICENSE file at http://angular.io/license -->